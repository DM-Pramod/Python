import os
import pandas as pd

def export_first_row_to_csv(obj, output_dir):
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    for attr_name in dir(obj):
        attr_value = getattr(obj, attr_name)
        if isinstance(attr_value, pd.DataFrame):
            # Get the first row of the DataFrame
            single_row_df = attr_value.head(1)
            # Convert Timestamps to strings
            single_row_df = single_row_df.applymap(lambda x: x.isoformat() if isinstance(x, pd.Timestamp) else x)
            # Define the CSV file path
            csv_file_path = os.path.join(output_dir, f"{attr_name}.csv")
            # Export the single row DataFrame to CSV
            single_row_df.to_csv(csv_file_path, index=False)
            print(f"Exported first row of {attr_name} to {csv_file_path}")
